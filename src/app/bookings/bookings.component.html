<div class="container">
    <div class="row">
        <div class="col-12 my-2">
            <label for="search-box">Confirmation Code</label>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <input
                class="w-100 p-2 mb-3"
                #searchBox
                id="search-box"
                autocomplete="off"
                (input)="onInput(searchBox.value)"
            />
        </div>
    </div>
    <div class="row">
        <div class="col-6">
            <select
                class="custom-select-sm w-auto"
                name="pageSize"
                [formControl]="pageSizeControl"
            >
                <option [ngValue]="10">10 items per page</option>
                <option [ngValue]="25">25 items per page</option>
                <option [ngValue]="50">50 items per page</option>
            </select>
        </div>
        <div class="col-6">
            <button
                type="button"
                class="btn btn-primary float-right"
                (click)="openAddModal()"
            >
                New
            </button>
        </div>
    </div>
    <div
        class="row border border-dark p-1"
        *ngFor="let booking of foundBookings; index as i"
    >
        <div class="col-6 col-sm-1 p-1 text-center">
            <button
                type="button"
                class="btn btn-outline-dark p-1 m-1"
                (click)="toggleActive(booking)"
            >
                <b *ngIf="booking.active; else elseBlock">Deactivate</b>
                <ng-template #elseBlock><b>Activate</b></ng-template>
            </button>
        </div>
        <div class="col-6 col-sm-2 p-1 text-center">
            <b>Confirmation Code</b>
            <div>
                <ngb-highlight
                    [result]="booking.confirmationCode"
                    [term]="searchTerm"
                ></ngb-highlight>
            </div>
        </div>
        <div class="col-6 col-sm-2 p-1 text-center">
            <b>Layover Count</b>
            <div>
                {{ booking.layoverCount }}
            </div>
        </div>
        <div class="col-6 col-sm-1 p-1 text-center">
            <b>Total Price</b>
            <div>
                {{ booking.totalPrice }}
            </div>
        </div>
        <div class="col-6 col-sm-1 p-1 text-center">
            <button
                type="button"
                class="btn btn-outline-dark mx-auto my-0"
                (click)="toggleCollapsibleRow('USER', i)"
            >
                User
            </button>
        </div>
        <div class="col-6 col-sm-2 p-1 text-center">
            <button
                type="button"
                class="btn btn-outline-dark mx-auto my-0"
                (click)="showPassengers(booking.confirmationCode)"
            >
                Passengers
            </button>
        </div>
        <div class="col-6 col-sm-1 p-1 text-center">
            <button
                type="button"
                class="btn btn-outline-dark mx-auto my-0"
                (click)="showFlights(booking.confirmationCode)"
            >
                Flights
            </button>
        </div>
        <div class="col-6 col-sm-2 p-1 text-center">
            <button
                type="button"
                class="btn btn-outline-dark mx-auto my-0"
                (click)="toggleCollapsibleRow('PAYMENT', i)"
            >
                Payment
            </button>
        </div>
        <div
            class="col-12"
            *ngIf="
                selectedTable === 'USER' && passengerIndex === i && rowExpanded
            "
        >
            <app-user-row [userData]="booking"></app-user-row>
        </div>
        <div
            class="col-12"
            *ngIf="
                selectedTable === 'PAYMENT' &&
                passengerIndex === i &&
                rowExpanded
            "
        >
            <app-payment-row [booking]="booking"></app-payment-row>
        </div>
    </div>

    <div class="d-flex justify-content-center py-3">
        <ngb-pagination
            [collectionSize]="foundBookings.length"
            [(page)]="pageNumber"
            [pageSize]="pageSizeControl.value"
        ></ngb-pagination>
    </div>
</div>
